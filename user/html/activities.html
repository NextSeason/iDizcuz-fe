<!DOCTYPE html>
<html>
    <head>
        <?php 
            $title = '';
        ?>
        @Include::common::head.inc.html
        <link rel="stylesheet" type="text/css" href="@Static::css/home.css" />
        <link rel="stylesheet" type="text/css" href="@Static::css/activities.css" />
    </head>
    <body>
        <div id="idizcuz" data-account-id="<?php echo $user['id']; ?>">
            @Include::common::top.inc.html
            <div class="boxes body">
                <div class="inner">
                    <div class="aside">
                        @Include::card.inc.html
                    </div>
                    <div class="main">
                        @Include::nav.inc.html
                        <ul class="activity-list"></ul>
                        <a class="load-more">
                            加载更多动态
                            <i class="fa fa-angle-double-down"></i>
                        </a>
                    </div>
                </div>
            </div>
            @Include::common::foot.inc.html
        </div>
        <textarea class="templates" id="activity-list-tpl">
            <% if( !data.length ) { %>
                <li>
                    <p class="empty">
                        暂时没有用户动态
                    </p>
                </li>
            <% } else { %>
                <% for( var i = 0, l = data.length; i < l; i += 1 ) { %>
                    <% var item = data[i], type = item.type; %>
                    <li>
                        <div class="activities">
                            <div class="hline clearfix">
                                <span class="date r"><%=item.ctime.substr(0,10) %></span>
                                <a href="/user/activities/<%=item.account_id %>" target="_blank"><%-item.account.uname %></a>
                                <% if( type == 0 ) { %>
                                    发布了新的论述
                                <% } else if( type == 1 ) {%>
                                    支持了论述
                                <% } else if( type == 2 ) {%>
                                    反对了论述
                                <% } else if( type == 3 ) {%>
                                    评论了论述
                                <% } else if( type == 4 ) {%>
                                    关注了 <a href="/user/activities/<%=item.extra.id %>"><%-item.extra.uname %></a>
                                <% } %>
                            </div>
                            <div class="extra">
                                <% if( type == 0 || type == 1 || type == 2 ) { %>
                                    <% var post = item.extra; %>
                                    @Include::post.tpl.inc.html
                                <% } else if( type == 3 ) {%>
                                    <% var comment = item.extra; %>
                                    <div class="extra-comments">
                                        <p>评论内容：<%-comment.content %></p>
                                    </div>
                                    <div class="relation_post">
                                        <p>相关论述：<a href="/post/<%=comment.post.id %>"><%-comment.post.title %></a></p>
                                    </div>
                                <% } else if( type == 4 ) {%>
                                    <% var card = item.extra; %>
                                    @Include::card_h.tpl.html
                                <% } %>
                            </div>
                        </div>
                    </li>
                <% } %>
            <% } %>
        </textarea>
        <script>
            var iDizcuz = new J();
            iDizcuz.mount( 'activities', '@Package::Activities', { self : <?php echo $self ? 1 : 0; ?>});
        </script>
        @Include::common::end.inc.html
    </body>
</html>
